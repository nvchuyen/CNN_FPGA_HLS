


#include <stdio.h>
#include <stdlib.h>
#include "headers1/buffer.h"
//#include "headers1/weights.h"
#include "headers1/defines.h"
#include <hls_stream.h>


#define eps 0.00002


float image [8][8] [32] =

		{{{0.0,0.0,0.0,0.7821629,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.8070439,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.7943852,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {1.6912414,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,1.2992958,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {1.9781452,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,1.2126435,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.47265643,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,1.7548473,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0}},

		 {{0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,2.1032712,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.6625899,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,6.3268204,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {1.3027036,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.8112439,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {2.0600982,0.0,0.0,0.0,0.053962946,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.5780189,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.6687673,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0}},

		 {{0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.11442512,0.0},
		  {0.0,0.0,0.0,0.0,0.0,1.6489718,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,2.7954829,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   2.4821653,0.0,0.0,0.0,0.0,0.0,0.93576515,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   2.4510741,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.1860026,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.2987258,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0}},

		 {{0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,1.1699009,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.9172008,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,3.292277,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0}},

		 {{0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.20522863,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,4.603656,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,3.9726608,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,6.553823,0.14291477,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,6.2972517,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.64429617,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.8062671,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.25882745,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.05350828,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.1712248,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0}},

		 {{0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.85193855,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,2.6802566,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,4.4428673,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,1.4857734,0.0,0.0,0.0,5.2930813,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,5.767952,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,2.144994,0.0,0.0,0.0,0.0,1.7022734,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   1.548046,0.0,0.0,0.0,0.0,0.0}},

		 {{0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.30969477,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.33956492,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,1.5559452,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,4.153136,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,1.8820939,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,1.8956494,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,1.4090488,0.0,0.0,0.0,0.0,0.0,0.0,
		   1.1493245,0.6438469,0.0,0.0,0.0,0.0}},

		 {{0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.15063477,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   1.0321834,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   1.2620618,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,2.046446,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   1.9925451,0.0,0.0,0.0,0.0},
		  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		   0.1158694,1.837673,0.0,0.0,0.0,0.0}}};


float pool_ref[4][4][32]=
{{{0.0,0.0,0.0,0.7821629,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0},
  {0.8070439,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.7943852,0.0,0.0,0.0,0.0,2.1032712,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
  {1.6912414,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.6625899,
   0.0,0.0,0.0,1.2992958,0.0,0.0,0.0,0.0,0.0,6.3268204,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
  {2.0600982,0.0,0.0,0.0,0.5780189,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,1.2126435,0.0,0.0,0.0,0.0,1.7548473,0.0,0.0,
   0.0,0.0,0.47265643,0.0,0.0,0.0,0.0,0.0,0.0,0.0}},

 {{0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0},
  {0.0,0.0,0.0,0.0,0.0,1.6489718,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,1.1699009,0.0,2.7954829,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.11442512,0.0},
  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   2.4821653,0.0,0.0,0.0,0.0,0.0,0.93576515,0.0,0.0,
   1.9172008,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,3.292277,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0}},

 {{0.0,0.20522863,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0},
  {0.0,4.603656,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,6.553823,4.4428673,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.64429617,0.0,6.2972517,0.0,0.0,0.0,5.767952,0.0,0.0,
   0.0,0.0,0.8062671,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.05350828,0.0,0.0,0.0,0.0,2.144994,0.0,0.0,0.0,
   1.1712248,1.7022734,0.0,1.548046,0.0,0.0,0.0,0.0,0.0}},

 {{0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.15063477,0.0,0.0,0.0,
   0.0,0.0,1.2620618,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   1.0321834,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.30969477,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.33956492,0.0,0.0,0.0,0.0,0.0},
  {0.0,0.0,0.0,0.0,0.0,2.046446,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.153136,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0},
  {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
   0.0,0.0,0.0,0.0,0.0,1.8820939,0.0,0.0,0.0,0.0,0.0,0.0,
   1.1493245,1.9925451,0.0,0.0,0.0,0.0}}};

void pooling_layer2(hls::stream<float24_t>& in, hls::stream<float24_t>& out );


int main()
{

	float24_t pool_out[P2_SIZE * P2_SIZE * P2_CHANNELS];
//	float24_t pool_ref[P2_SIZE][P2_SIZE][P2_CHANNELS];
//	float24_t image[A1_SIZE * A1_SIZE * A1_CHANNELS];
	float a;

	int i,j,k;
	int m, n, p;
	int correct_values = 0, total_values = 0;
	hls::stream<float24_t> out("output_stream");
	hls::stream<float24_t> in("input_stream");

//	int correct_values = 0;
//	int error_values =0;

//	for(i = 0 ; i < A1_SIZE * A1_SIZE * A1_CHANNELS; i++)
//	{
//		in<<image_test[i];
//		x = image_test[i];
//	}
//
	for(m = 0; m<8 ; m++)
		{
			for (n = 0 ; n< 8; n++)
			{
				for(p = 0; p < 32; p++)
				{
					in<<image[m][n][p];
				}
			}
		}

	pooling_layer2(in, out);



	/// Receive stream
	for(i = 0 ; i < P2_SIZE * P2_SIZE * P2_CHANNELS; i++)
	{
			out>>pool_out[i];
			printf("%d  %f    \n", i ,pool_out[i]);
	}

	printf("Checking POOL  ...\n");

	for(k = 0; k < P2_CHANNELS; k++)
		for(i = 0; i < P2_SIZE; i++)
			for(j = 0; j < P2_SIZE; j++)
			{
				total_values++;
				if(pool_out[i * P2_SIZE * P2_CHANNELS + j * P2_CHANNELS + k] - pool_ref[i][j][k] > eps || pool_ref[i][j][k] - pool_out[i * P2_SIZE * P2_CHANNELS + j * P2_CHANNELS + k] > eps)
				{
					if(correct_values + 1 == total_values)
						printf("Missmatch in POOL check\n");
				}
				else
					correct_values++;
			}
	printf("DONE: %d out of %d are correct\n\n", correct_values, total_values);

	return 0;
}
